(function(){"use strict";var e={255:function(e,s,t){var a=t(963),i=t(252);function n(e,s,t,a,n,l){const o=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(o)}const l={class:"base"},o={key:1};function r(e,s,t,n,r,d){const h=(0,i.up)("user-chat-low"),c=(0,i.up)("LogChat"),u=(0,i.up)("UserChat");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(a.uT,{name:"fade"},{default:(0,i.w5)((()=>[r.isHigh?((0,i.wg)(),(0,i.iD)("div",o,[r.isIn?((0,i.wg)(),(0,i.j4)(u,{key:1,bcol:r.bcol,isHigh:r.isHigh,onLogOut:d.logOut,onCollapse:d.chiba},null,8,["bcol","isHigh","onLogOut","onCollapse"])):((0,i.wg)(),(0,i.j4)(c,{key:0,bcol:r.bcol,onIsLogOk:d.userLogging,onCollapse:d.chiba},null,8,["bcol","onIsLogOk","onCollapse"]))])):((0,i.wg)(),(0,i.j4)(h,{key:0,chatColor:r.bcol,onSetLow:d.chiba},null,8,["chatColor","onSetLow"]))])),_:1})])}var d={data(){return{myProxy:"http://31.28.9.200:23765"}},methods:{dateFocuses(){let e=new Date,s=e.getFullYear().toString(),t=e.getMonth()+1,a=e.getDate().toString(),i=e.getHours().toString(),n=e.getMinutes().toString(),l=e.getSeconds().toString();a<10&&(a="0"+a),t<10&&(t="0"+t.toString()),i<10&&(i="0"+i),n<10&&(n="0"+n),l<10&&(l="0"+l);const o=s+"-"+t+"-"+a+" "+i+":"+n+":"+l;return o},isImage(e){if(null!==e)return".jpg"===e.substr(-4)||".gif"===e.substr(-4)||".png"===e.substr(-4)||"jpeg"===e.substr(-4)},scrollToEnd(){this.$refs.chatter.scrollTop=this.$refs.chatter.scrollHeight}}},h=t(577);const c=e=>((0,i.dD)("data-v-57ca85ed"),e=e(),(0,i.Cn)(),e),u=c((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"})],-1))),g=[u],m={class:"login__form__inner"},p=c((()=>(0,i._)("h1",null,"Регистрация",-1))),_=c((()=>(0,i._)("label",{for:"username"},"Имя (2-15 символов)",-1)));function f(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",{class:"login",style:(0,h.j5)({backgroundColor:t.bcol})},[(0,i._)("header",null,[(0,i._)("button",{class:"login__collapse-button",onClick:s[0]||(s[0]=e=>this.$emit("collapse"))},g)]),(0,i._)("form",{class:"login__form",onSubmit:s[3]||(s[3]=(0,a.iM)(((...e)=>o.logIn&&o.logIn(...e)),["prevent"]))},[(0,i._)("div",m,[p,_,(0,i.wy)((0,i._)("input",{id:"username",type:"text","onUpdate:modelValue":s[1]||(s[1]=e=>l.username=e),placeholder:"Введите имя..."},null,512),[[a.nr,l.username]]),(0,i.wy)((0,i._)("input",{id:"email",type:"text","onUpdate:modelValue":s[2]||(s[2]=e=>l.email=e),placeholder:"Введите адрес почты"},null,512),[[a.nr,l.email]]),(0,i._)("input",{style:(0,h.j5)({backgroundColor:t.bcol}),type:"submit",value:"Войти"},null,4),(0,i._)("p",null,(0,h.zw)(l.logError),1)])],32)],4)}var w=t(669),v=t.n(w),C={data(){return{username:null,logError:null,isIn:!1,userId:null,email:null,messages:[]}},mixins:[d],props:{bcol:{type:String,default:"#7B68EE"}},methods:{checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.$emit("isLogOk",!0)):this.$emit("isLogOk",!1)},async logIn(){if(this.email||this.username)if(this.username=this.username.trim(),!this.username||this.username.length>15||this.username.length<2)this.logError="Введите верное имя";else if(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(this.email)){this.logError=null;const e={params:{name:this.username,email:this.email}};console.log("Starting"),await v().post(`${this.myProxy}/api/users/add`,null,e).then((e=>{e.data.error?(console.log(e.data.error),"User banned"===e.data.error?this.logError="Вы заблокированы":this.logError="Введите верное имя",this.$emit("isLogOk",!1)):(console.log("all is ok"),console.log(e.data),sessionStorage.setItem("user_id",e.data.id),sessionStorage.setItem("user_email",e.data.email),sessionStorage.setItem("user_name",e.data.name),sessionStorage.setItem("user_status",e.data.status),this.checkAuth())}))}else this.logError="Неправильный email!";else this.logError="Введите имя!"}}},y=t(744);const b=(0,y.Z)(C,[["render",f],["__scopeId","data-v-57ca85ed"]]);var M=b;function k(e,s,t,a,n,l){const o=(0,i.up)("user-chat-header"),r=(0,i.up)("user-chat-messages"),d=(0,i.up)("user-chat-type-message");return(0,i.wg)(),(0,i.iD)("div",{class:"chat",style:(0,h.j5)({backgroundColor:t.bcol})},[(0,i.Wm)(o,{onCollapse:l.chiba,onLogOutUserChat:l.logOutUC},null,8,["onCollapse","onLogOutUserChat"]),(0,i.Wm)(r,{newMessage:n.myNewMessage},null,8,["newMessage"]),(0,i.Wm)(d,{onSendMessage:l.sendingMessage},null,8,["onSendMessage"])],4)}const S=e=>((0,i.dD)("data-v-ffc65c56"),e=e(),(0,i.Cn)(),e),D=S((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"})],-1))),L=[D],x=S((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"currentColor",class:"bi bi-box-arrow-in-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),(0,i._)("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})],-1))),U=[x],I={class:"header__greeting"};function O(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)("header",null,[(0,i._)("button",{class:"header__buttons",onClick:s[0]||(s[0]=(...e)=>l.chiba&&l.chiba(...e))},L),(0,i._)("button",{class:"logout",onClick:s[1]||(s[1]=(...e)=>l.logOutHeader&&l.logOutHeader(...e))},U),(0,i._)("h1",I," Здравствуйте, "+(0,h.zw)(n.username),1)])}var A={data(){return{username:sessionStorage.getItem("user_name")}},methods:{chiba(){this.$emit("collapse")},logOutHeader(){this.$emit("logOutUserChat")}}};const B=(0,y.Z)(A,[["render",O],["__scopeId","data-v-ffc65c56"]]);var z=B;const $=e=>((0,i.dD)("data-v-55e3acdd"),e=e(),(0,i.Cn)(),e),H={class:"user-message-history",ref:"chatter"},T={key:0},F={class:"user-message-history__messages-list__message-inner"},j={class:"user-message-history__messages-list__message-inner__username"},P=["href"],E=["src"],V=["href"],N=$((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-cloud-arrow-down",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708l2 2z"}),(0,i._)("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})],-1)));function Z(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)("section",H,[n.isBanned?((0,i.wg)(),(0,i.iD)("p",T," Вы заблокированы и не можете отправлять сообщения ")):!n.isBanned&&n.isLoading?((0,i.wg)(),(0,i.iD)("div",{key:1,style:(0,h.j5)(`border-top: 16px solid ${t.bcol}`),class:"user-message-history__loader"},null,4)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:2},(0,i.Ko)(n.messages,(s=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["user-message-history__messages-list","User"===s.role?"current-user":null])},[(0,i._)("div",F,[(0,i._)("div",j,(0,h.zw)(s.name),1),(0,i._)("div",{style:(0,h.j5)("User"===s.role?{backgroundColor:t.bcol}:"background-color: #F3F3F3;"),class:"user-message-history__messages-list__message-inner__content"},[(0,i.Uk)((0,h.zw)(s.message)+" ",1),0!==s.file.length?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(s.file,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[e.isImage(s.file[a].name)?((0,i.wg)(),(0,i.iD)("a",{key:0,href:l.getFiles(s.file[a].name),target:"_blank"},[(0,i._)("img",{class:"user-message-history__messages-list__message-inner__content__img",src:l.getFiles(s.file[a].name)},null,8,E)],8,P)):((0,i.wg)(),(0,i.iD)("a",{key:1,href:l.getFiles(s.file[a].name),class:"user-message-history__messages-list__message-inner__content__links",target:"_blank"},[N,(0,i.Uk)(" "+(0,h.zw)(s.file[a].name),1)],8,V))])))),128)):(0,i.kq)("",!0)],4)])],2)))),256))],512)}var R={data(){return{isLoading:!0,messages:[],isBanned:!1}},mixins:[d],props:{bcol:{type:String,default:"#7B68EE"},newMessage:{type:Object,default:null}},methods:{getFiles(e){const s=this.myProxy+"/api/file/"+e;return s},checkStatus(){"Banned"===sessionStorage.getItem("user_status")?this.isBanned=!0:this.isBanned=!1},async getMessages(){if(this.checkStatus(),!this.isBanned){const e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{user_id:sessionStorage.getItem("user_id")}};console.log(e),await v().get(`${this.myProxy}/api/users/messages`,e).then((e=>{if(console.log(e),e.data.error)alert("ошибка соединения");else{this.messages=[];let s={};for(let t=0;t<e.data.length;t++)s={user_id:e.data[t].user_id,name:"Admin"===e.data[t].status?"Admin":sessionStorage.getItem("user_name"),message:e.data[t].message,role:"Admin"===e.data[t].status?"Admin":"User",file:e.data[t].file},this.messages.push(s);this.isLoading=!1}}))}},addNewMessage(){this.messages.push(this.newMessage)}},created(){this.getMessages()},watch:{newMessage(){this.addNewMessage()},messages:{handler(e,s){setTimeout(this.scrollToEnd,200)},deep:!0}}};const Y=(0,y.Z)(R,[["render",Z],["__scopeId","data-v-55e3acdd"]]);var K=Y;const Q=e=>((0,i.dD)("data-v-e4bf2ba2"),e=e(),(0,i.Cn)(),e),W={class:"input-msg-form__butt"},G=Q((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-arrow-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})],-1))),q=[G],J=Q((()=>(0,i._)("input",{type:"submit",id:"subBut",value:"Отпр."},null,-1))),X=Q((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-folder-symlink",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"m11.798 8.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"}),(0,i._)("path",{d:"m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm.694 2.09A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09l-.636 7a1 1 0 0 1-.996.91H2.826a1 1 0 0 1-.995-.91l-.637-7zM6.172 2a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"})],-1))),ee=[X],se={class:"files-area"};function te(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("footer",null,[(0,i._)("form",{class:"input-msg-form",onSubmit:s[3]||(s[3]=(0,a.iM)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["prevent"]))},[(0,i.wy)((0,i._)("textarea",{ref:"inpMes",onKeyup:s[0]||(s[0]=(0,a.D2)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["enter"])),"onUpdate:modelValue":s[1]||(s[1]=e=>l.userMessage=e),rows:"2",cols:"4",placeholder:"Написать сообщение..."},null,544),[[a.nr,l.userMessage]]),(0,i._)("div",W,[(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.bcol}),for:"subBut"},q,4),J,(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.bcol}),for:"fileUp"},ee,4),(0,i._)("input",{ref:"file",onChange:s[2]||(s[2]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),id:"fileUp",type:"file"},null,544)])],32),l.files.length>0?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)(l.files,(e=>((0,i.wg)(),(0,i.iD)("div",se,[(0,i._)("p",null,(0,h.zw)(e.name)+" ",1)])))),256)):(0,i.kq)("",!0)])}var ae={data(){return{files:[],userMessage:"",telegramToken:"5363461740:AAFGrcOV0zd6f28zyKsI_GFFLQylb7A_dFY",telegramChatId:1173830066}},mixins:[d],methods:{sendMessage(){let e=[];if(this.files.length>0)console.log("with files"),this.files.forEach((s=>{e.push(s.name)})),""!==this.userMessage&&(this.userMessage=this.userMessage.trim());else if(e=[],""===this.userMessage||"\n"===this.userMessage)return this.userMessage="",void alert("Введите сообщение");let s={name:sessionStorage.getItem("user_name"),user_id:sessionStorage.getItem("user_id"),message:this.userMessage,status:"User",role:"User",date:this.dateFocuses(),file:e};if(this.$socket.emit("user_message",s),"Actived"===sessionStorage.getItem("user_status")){const e=`User id:${s.user_id} %0AName: ${s.name} %0AText: ${s.message}`;v().post(`https://api.telegram.org/bot${this.telegramToken}/sendMessage?chat_id=${this.telegramChatId}&text=${e}`).then((e=>{console.log("Succes",e)}),(e=>{console.log(e)}))}s={name:sessionStorage.getItem("user_name"),user_id:sessionStorage.getItem("user_id"),message:this.userMessage,status:"User",role:"User",date:this.dateFocuses(),file:this.files},console.log(s),this.$emit("sendMessage",s),this.userMessage="",this.files=[],console.log("Сообщение отправлено")},async handleFileUpload(){let e=new FormData;e.append("file",this.$refs.file.files[0]),console.log(this.$refs.file.files[0]),await v().post(`${this.myProxy}/api/file/upload`,e,{headers:{"Content-type":"multipart/form-data"}}).then((s=>{console.log(s),console.log("Успешно отправлен файл");let t={name:s.data,file:e,fileURL:window.URL.createObjectURL(this.$refs.file.files[0])};this.files.push(t)})).catch((e=>{console.log(e)}))}},props:{bcol:{type:String,default:"#7B68EE"}}};const ie=(0,y.Z)(ae,[["render",te],["__scopeId","data-v-e4bf2ba2"]]);var ne=ie,le={components:{UserChatHeader:z,UserChatMessages:K,UserChatTypeMessage:ne},data(){return{username:null,myNewMessage:null}},mixins:[d],props:{bcol:{type:String,default:"#7B68EE"}},methods:{soundNotification(){let e=new Audio;e.src="https://ringon.site/?do=get-file&id=34361",e.volume=.3,e.play()},userResponce(){this.$socket.emit("connected",{id:sessionStorage.getItem("user_id")}),this.sockets.subscribe("user_response",(e=>{if(e.error)"User banned"===e.error&&(sessionStorage.setItem("user_status","Banned"),this.chiba()),console.log(e.error);else{console.log("Сообщение получено");let s=[];for(let a=0;a<e.file.length;a++)s.push({name:e.file[a]});const t={name:"Admin",message:e.message,role:"Admin",file:s};console.log(t),this.myNewMessage=t,this.soundNotification()}}))},chiba(){this.$emit("collapse")},logOutUC(){this.$emit("logOut")},sendingMessage(e){this.myNewMessage=e},checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&null!==sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.$emit("isLogOk",!0),this.userResponce()):this.$emit("isLogOk",!1)}},mounted(){this.checkAuth()}};const oe=(0,y.Z)(le,[["render",k],["__scopeId","data-v-5903f876"]]);var re=oe;const de=e=>((0,i.dD)("data-v-151bffce"),e=e(),(0,i.Cn)(),e),he=["fill"],ce=de((()=>(0,i._)("path",{d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm5.904-2.803a.5.5 0 1 0-.707.707L9.293 10H6.525a.5.5 0 0 0 0 1H10.5a.5.5 0 0 0 .5-.5V6.525a.5.5 0 0 0-1 0v2.768L5.904 5.197z"},null,-1))),ue=[ce],ge=(0,i.Uk)(" Жмакни ");function me(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["lowbe","left"===t.chatPosition?"positionLeft":"positionRight"]),style:(0,h.j5)({backgroundColor:t.chatColor}),onClick:s[0]||(s[0]=e=>this.$emit("setLow"))},[(0,i._)("p",{style:(0,h.j5)({color:t.mainTextColor})},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:t.mainTextColor,class:"bi bi-arrow-down-right-circle-fill",viewBox:"0 0 16 16"},ue,8,he)),ge],4)],6)}var pe={props:{chatColor:{type:String,default:"#7B68EE"},mainTextColor:{type:String,default:"#ffffff"},chatPosition:{type:String,default:"right"}}};const _e=(0,y.Z)(pe,[["render",me],["__scopeId","data-v-151bffce"]]);var fe=_e,we={components:{LogChat:M,UserChat:re,UserChatLow:fe},mixins:[d],data(){return{connection:null,username:null,messages:[],userMessage:null,isHigh:!1,logError:null,isIn:!1,userId:null,bcol:"#7B68EE",email:null}},sockets:{connect:function(){console.log("socket connected")}},methods:{chiba(){this.isHigh=!this.isHigh},logOut(){console.log("дисконнектюсь"),this.sockets.unsubscribe("message_response"),sessionStorage.clear(),this.isIn=!1},userLogging(e){this.isIn=e},checkAuth(){"undefined"!==sessionStorage.getItem("user_id")&&null!==sessionStorage.getItem("user_id")?(this.username=sessionStorage.getItem("user_name"),this.isIn=!0):this.isIn=!1}},mounted(){this.checkAuth()}};const ve=(0,y.Z)(we,[["render",r],["__scopeId","data-v-bcb01478"]]);var Ce=ve;const ye=e=>((0,i.dD)("data-v-0186b900"),e=e(),(0,i.Cn)(),e),be={class:"messenger"},Me={key:0,class:"messenger__clients"},ke=ye((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"white",class:"bi bi-chevron-double-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"}),(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"})],-1))),Se=[ke],De={key:2,class:"all-collapse"},Le=ye((()=>(0,i._)("h1",null,[(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"2.5rem",height:"2.5rem",fill:"currentColor",class:"bi bi-caret-left",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"M10 12.796V3.204L4.519 8 10 12.796zm-.659.753-5.48-4.796a1 1 0 0 1 0-1.506l5.48-4.796A1 1 0 0 1 11 3.204v9.592a1 1 0 0 1-1.659.753z"})]),(0,i.Uk)("Выберите пользователя чтобы начать с ним диалог ")],-1))),xe=[Le];function Ue(e,s,t,a,n,l){const o=(0,i.up)("admin-clients-header"),r=(0,i.up)("admin-style-changer"),d=(0,i.up)("admin-clients-list"),c=(0,i.up)("admin-messages"),u=(0,i.up)("admin-write-message");return(0,i.wg)(),(0,i.iD)("div",be,[n.clientOpen?((0,i.wg)(),(0,i.iD)("div",Me,[(0,i.Wm)(o,{onMessOpen:l.openClients,onClose:l.toClose,onStatus:l.changeStatus,onUpdateSearchQuery:l.searchRequest,onChangeStyleChat:l.openChangeStyle},null,8,["onMessOpen","onClose","onStatus","onUpdateSearchQuery","onChangeStyleChat"]),n.isChangingStyleOpen?((0,i.wg)(),(0,i.j4)(r,{key:0})):((0,i.wg)(),(0,i.j4)(d,{key:1,onOpenMessage:l.openMessages,chosenStatus:n.chosenStatus,newLastMessage:n.lastMessageToUpdate,newClient:n.addNewUser,endDialogUserId:n.userIdEndDialog,searchText:n.searchQueryText},null,8,["onOpenMessage","chosenStatus","newLastMessage","newClient","endDialogUserId","searchText"]))])):((0,i.wg)(),(0,i.iD)("div",{key:1,class:"messenger__clients-collapse",onClick:s[0]||(s[0]=e=>n.clientOpen=!n.clientOpen)},Se)),n.clientOpen||n.isMessageOpen?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",De,xe)),(0,i._)("div",{class:"messenger__messages",style:(0,h.j5)({display:n.isMessageOpen?n.db:n.dn})},[(0,i.Wm)(c,{chosenStatus:n.chosenStatus,userId:n.messagesUserId,sendMessage:n.lastMessageToUpdate,onEndDialog:l.endDialog},null,8,["chosenStatus","userId","sendMessage","onEndDialog"]),(0,i.Wm)(u,{onUpdateLastMessage:l.updateClientList,chsAct:n.messagesUserId},null,8,["onUpdateLastMessage","chsAct"])],4)])}const Ie=e=>((0,i.dD)("data-v-88588c44"),e=e(),(0,i.Cn)(),e),Oe={class:"clients-header"},Ae={class:"clients-header__topic"},Be=(0,i.Uk)("Клиенты "),ze={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-double-right",viewBox:"0 0 16 16"},$e=Ie((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"},null,-1))),He=Ie((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"},null,-1))),Te=[$e,He],Fe={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-double-left",viewBox:"0 0 16 16"},je=Ie((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"},null,-1))),Pe=Ie((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"},null,-1))),Ee=[je,Pe],Ve={class:"clients-header__seach-bar"},Ne=Ie((()=>(0,i._)("span",{class:"clients-header__input-group-addon"},[(0,i._)("button",{type:"button"},[(0,i._)("i",{class:"fa fa-search","aria-hidden":"true"})])],-1))),Ze={class:"status_list"};function Re(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",Oe,[(0,i._)("div",Ae,[(0,i._)("h4",{onClick:s[0]||(s[0]=(...e)=>o.visClients&&o.visClients(...e))},[Be,l.clientOpen?((0,i.wg)(),(0,i.iD)("svg",Fe,Ee)):((0,i.wg)(),(0,i.iD)("svg",ze,Te))]),(0,i._)("h4",{onClick:s[1]||(s[1]=(...e)=>o.toClose&&o.toClose(...e))},"Выход")]),(0,i._)("div",Ve,[(0,i._)("h4",{onClick:s[2]||(s[2]=(...e)=>o.toChangeStyle&&o.toChangeStyle(...e))},"Дизайн чата"),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>l.searchQuery=e),type:"text",placeholder:"Поиск"},null,512),[[a.nr,l.searchQuery]]),Ne])])]),(0,i._)("div",Ze,[(0,i._)("ul",null,[(0,i._)("li",{onClick:s[4]||(s[4]=(0,a.iM)((e=>l.chosenStatus=1),["prevent"])),class:(0,h.C_)({activeStatus:1===l.chosenStatus})},"Активные",2),(0,i._)("li",{onClick:s[5]||(s[5]=(0,a.iM)((e=>l.chosenStatus=2),["prevent"])),class:(0,h.C_)({activeStatus:2===l.chosenStatus})},"Законченные",2),(0,i._)("li",{onClick:s[6]||(s[6]=(0,a.iM)((e=>l.chosenStatus=3),["prevent"])),class:(0,h.C_)({activeStatus:3===l.chosenStatus})},"Бан",2)])])],64)}var Ye={data(){return{clientOpen:!0,searchQuery:"",chosenStatus:1}},methods:{toClose(){this.$emit("close")},visClients(){this.clientOpen=!this.clientOpen,this.$emit("messOpen",this.clientOpen)},toChangeStyle(){this.$emit("changeStyleChat")}},watch:{chosenStatus(){this.$emit("status",this.chosenStatus)},searchQuery(e){this.$emit("updateSearchQuery",e)}}};const Ke=(0,y.Z)(Ye,[["render",Re],["__scopeId","data-v-88588c44"]]);var Qe=Ke;const We=e=>((0,i.dD)("data-v-711bcf81"),e=e(),(0,i.Cn)(),e),Ge={class:"client-list"},qe={key:0,class:"client-list__loader"},Je=["onClick"],Xe=We((()=>(0,i._)("div",{class:"client-list__client-img"},[(0,i._)("img",{src:"https://ptetutorials.com/images/user-profile.png",alt:"sunil"})],-1))),es={class:"client-list__last-message"},ss={key:0},ts={key:1},as={class:"client-list__observer",ref:"observer"};function is(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",Ge,[(0,i.Wm)(a.W3,{name:"fade"},{default:(0,i.w5)((()=>[l.isLoading?((0,i.wg)(),(0,i.iD)("div",qe)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(o.searchedList,(e=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["client-list__client-card",e.id===l.chsAct?"active_chat":null]),key:e.id,onClick:s=>o.chosenUser(e.id)},[Xe,(0,i._)("div",es,[(0,i._)("h5",null,[(0,i.Uk)((0,h.zw)(e.name)+" ",1),(0,i._)("span",null,(0,h.zw)(e.last_message.date.slice(0,-3)),1)]),""!==e.last_message.message&&null!==e.last_message.message?((0,i.wg)(),(0,i.iD)("p",ss,(0,h.zw)(e.last_message.message),1)):((0,i.wg)(),(0,i.iD)("p",ts,"[Вложение]"))])],10,Je)))),128))])),_:1}),(0,i._)("div",as,null,512)])}var ns={mixins:[d],data(){return{clientPages:1,currentClientPage:0,maxClientsPerPage:10,clientDataList:[],chsAct:null,fullClientDataList:[],isLoading:!0,searchQuery:""}},props:{chosenStatus:{type:Number,default:1},searchQuery:{type:String,default:""},isMessageOpen:{type:Boolean,default:!1},newLastMessage:{type:Object,default:{}},newClient:{type:Object,default:{}},endDialogUserId:{type:Number,default:null},searchText:{type:String,default:""}},methods:{paginationOut(e){console.log("Количество клиентов "+e),this.clientPages=Math.ceil(e/this.maxClientsPerPage)},chosenUser(e){this.chsAct=e,this.$emit("openMessage",e)},async endDialog(e){if(confirm("Вы уверены что хотите закончить диалог с пользователем?")){let s={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Disabled",id:e}};await v().post(`${this.myProxy}/api/users/new/status`,null,s).then((e=>{console.log(e)}));for(let t=0;t<this.clientDataList.length;t++)this.clientDataList[t].id===e&&(console.log(t),this.clientDataList.splice(t,1))}},addNewClient(e){if(console.log(e),e.new_chat){const s={id:e.user_id,name:e.name,status:"Actived",role:"User",date:e.date,last_message:e};this.clientDataList.unshift(s)}for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id===e.user_id&&(this.clientDataList[s].last_message=e)},async apiCallClients(){console.log("I am calling"),this.clientDataList=[],this.fullClientDataList=[];const e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"}};let s="";switch(this.chosenStatus){case 1:s="Actived";break;case 2:s="Disabled";break;case 3:s="Banned";break}await v().get(`${this.myProxy}/api/users/all/status?status=${s}`,e).then((e=>{console.log(e),this.paginationOut(e.data.length);for(let s=0;s<e.data.users.length;s++)this.fullClientDataList.push(e.data.users[s]);this.loadMoreClients()}))},updateLastMessage(e){for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id==e.user_id&&(this.clientDataList[s].last_message=e);this.sortClientListByDate()},sortClientListByDate(){this.clientDataList.sort(((e,s)=>Date.parse(s.last_message.date)-Date.parse(e.last_message.date)))},loadMoreClients(){console.log("яродился");const e=this.clientDataList.length;let s=this.clientDataList.length+this.maxClientsPerPage;this.fullClientDataList.length-e<this.maxClientsPerPage&&(s=e+(this.fullClientDataList.length-e));for(let t=e;t<s;t++)this.clientDataList.push(this.fullClientDataList[t]);this.isLoading=!1}},mounted(){this.apiCallClients();const e={rootMargin:"0px",threshold:0},s=(e,s)=>{e[0].isIntersecting&&this.loadMoreClients()},t=new IntersectionObserver(s,e);t.observe(this.$refs.observer)},watch:{chosenStatus(){this.currentClientPage=1,this.apiCallClients()},currentClientPage(){this.apiCallClients()},newLastMessage(e){this.updateLastMessage(e)},newClient(e){this.addNewClient(e)},endDialogUserId(e){for(let s=0;s<this.clientDataList.length;s++)this.clientDataList[s].id===e&&(console.log(s),this.clientDataList.splice(s,1))},searchText(e){this.searchQuery=e}},computed:{searchedList(){return""===this.searchQuery?[...this.clientDataList]:[...this.clientDataList].filter((e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase())))}}};const ls=(0,y.Z)(ns,[["render",is],["__scopeId","data-v-711bcf81"]]);var os=ls;const rs=e=>((0,i.dD)("data-v-9712b52e"),e=e(),(0,i.Cn)(),e),ds={key:0,class:"butt"},hs={class:"message-history",ref:"chatter"},cs={key:0,class:"message-history__loader"},us={key:0,class:"message-history__incoming-msg_img"},gs=rs((()=>(0,i._)("img",{src:"https://ptetutorials.com/images/user-profile.png",alt:"sunil"},null,-1))),ms=[gs],ps={key:0,class:"message-history__message-inner-file"},_s=["href"],fs=["src"],ws=["href"],vs=rs((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-file-earmark-arrow-down",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"}),(0,i._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"})],-1))),Cs=rs((()=>(0,i._)("br",null,null,-1))),ys={class:"message-history__time-date"};function bs(e,s,t,a,n,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[1===t.chosenStatus?((0,i.wg)(),(0,i.iD)("div",ds,[(0,i._)("button",{onClick:s[0]||(s[0]=(...e)=>l.endDialog&&l.endDialog(...e))},"Закрыть диалог"),(0,i._)("button",{onClick:s[1]||(s[1]=(...e)=>l.banUser&&l.banUser(...e))},"Забанить пользователя")])):(0,i.kq)("",!0),(0,i._)("div",hs,[n.isLoading?((0,i.wg)(),(0,i.iD)("div",cs)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(n.dialogMsgs,(s=>((0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__outgoing-message":"message-history__incoming-msg")},["Admin"!==s.status?((0,i.wg)(),(0,i.iD)("div",us,ms)):(0,i.kq)("",!0),(0,i._)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__sent-message":"message-history__received-message")},[(0,i._)("div",{class:(0,h.C_)("Admin"===s.status?"message-history__sent-message":"message-history__received-withd-msg")},[(0,i._)("p",null,[(0,i.Uk)((0,h.zw)(s.message)+" ",1),0!==s.file.length?((0,i.wg)(),(0,i.iD)("span",ps,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.file,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:t.id},[e.isImage(s.file[a].name)?((0,i.wg)(),(0,i.iD)("a",{key:0,href:l.getFiles(s.file[a].name),target:"_blank"},[(0,i._)("img",{src:l.getFiles(s.file[a].name)},null,8,fs)],8,_s)):((0,i.wg)(),(0,i.iD)("a",{key:1,href:l.getFiles(s.file[a].name),target:"_blank"},[vs,(0,i.Uk)((0,h.zw)(s.file[a].name)+" ",1),Cs],8,ws))])))),128))])):(0,i.kq)("",!0)]),(0,i._)("span",ys,(0,h.zw)(s.date.slice(0,-3)),1)],2)],2)],2)))),256))],512)],64)}var Ms={mixins:[d],data(){return{dialogMsgs:[],isLoading:!0}},props:{chosenStatus:{type:Number,default:1},userId:{type:Number,default:null},sendMessage:{type:Object,default:{}}},methods:{async getMessages(e){const s={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{user_id:e}};await v().get(`${this.myProxy}/api/users/messages`,s).then((e=>{console.log(e.data),this.dialogMsgs=[];for(let s=0;s<e.data.length;s++)this.dialogMsgs.push(e.data[s]);this.isLoading=!1}))},addMessage(e){console.log(e);let s=[],t=0;e.file.length>0&&e.file.forEach((e=>{s.push({id:t,name:e}),t++})),e.file=s,this.dialogMsgs.push(e)},getFiles(e){const s=this.myProxy+"/api/file/"+e;return s},async endDialog(){if(confirm("Вы уверены что хотите закончить диалог с пользователем?")){let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Disabled",id:this.userId}};await v().post(`${this.myProxy}/api/users/new/status`,null,e).then((e=>{console.log(e),this.$emit("endDialog",this.userId)}))}},async banUser(){if(confirm("Вы уверены что хотите заблокировать пользователем?")){let e={headers:{Authorization:"Bearer 5IdrO9woG1wvhOZYUNUdrO9vhOUoBIXTCBup2JdrOvhO9K"},params:{status:"Banned",id:this.userId}};await v().post(`${this.myProxy}/api/users/new/status`,null,e).then((e=>{console.log(e),this.$emit("endDialog",this.userId)}))}}},watch:{userId(e){this.isLoading=!0,this.getMessages(e)},dialogMsgs:{handler(e,s){setTimeout(this.scrollToEnd,200)},deep:!0},sendMessage(e){this.addMessage(e)}}};const ks=(0,y.Z)(Ms,[["render",bs],["__scopeId","data-v-9712b52e"]]);var Ss=ks;const Ds=e=>((0,i.dD)("data-v-1cf1a07e"),e=e(),(0,i.Cn)(),e),Ls={class:"input-msg-write"},xs=Ds((()=>(0,i._)("i",{class:"fa fa-paper-plane-o","aria-hidden":"true"},null,-1))),Us=[xs],Is=Ds((()=>(0,i._)("label",{class:"input-msg-write__file-uploader",for:"file"},[(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"white",class:"bi bi-file-earmark-arrow-down",viewBox:"0 -4 10 20"},[(0,i._)("path",{d:"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"}),(0,i._)("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"})])],-1))),Os={clas:"input-msg-write__file-button"},As={key:0},Bs={class:"input-msg-write__files_list"},zs=["href"];function $s(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",Ls,[(0,i.wy)((0,i._)("textarea",{onKeyup:s[0]||(s[0]=(0,a.D2)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["enter"])),"onUpdate:modelValue":s[1]||(s[1]=e=>l.adminMsg=e),class:"input-msg-write__area",cols:"30",rows:"4",placeholder:"Введите сообщение"},null,544),[[a.nr,l.adminMsg]]),(0,i._)("button",{onClick:s[2]||(s[2]=(...e)=>o.sendMessage&&o.sendMessage(...e)),class:"input-msg-write__send-btn",type:"button"},Us),Is,(0,i._)("input",{type:"file",id:"file",onInput:s[3]||(s[3]=(...e)=>o.handleFileUpload&&o.handleFileUpload(...e)),ref:"file"},null,544),(0,i._)("div",Os,[l.files.length>0?((0,i.wg)(),(0,i.iD)("div",As,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.files,(e=>((0,i.wg)(),(0,i.iD)("div",Bs,[(0,i._)("a",{href:e.fileURL,target:"_blank"},(0,h.zw)(e.name)+" ",9,zs)])))),256))])):(0,i.kq)("",!0)])])}var Hs={data(){return{adminMsg:"",files:[]}},props:{chsAct:{type:Number,default:null}},mixins:[d],methods:{async handleFileUpload(){let e=new FormData;e.append("file",this.$refs.file.files[0]),console.log(this.$refs.file.files[0]),await v().post(`${this.myProxy}/api/file/upload`,e,{headers:{"Content-type":"multipart/form-data"}}).then((s=>{console.log(s),console.log("Успешно отправлен файл");let t={name:s.data,file:e,fileURL:window.URL.createObjectURL(this.$refs.file.files[0])};this.files.push(t)})).catch((e=>{console.log(e)}))},sendMessage(){let e=[];if(this.files.length>0)console.log("with files"),this.files.forEach((s=>{e.push(s.name)})),""!==this.adminMsg&&(this.adminMsg=this.adminMsg.trim());else if(e=[],""===this.adminMsg||"\n"===this.adminMsg)return this.adminMsg="",void alert("Введите сообщение");let s={name:"Admin",user_id:this.chsAct,message:this.adminMsg,status:"Admin",date:this.dateFocuses(),file:e};this.$socket.emit("admin_send_message",s),console.log(s),this.$emit("updateLastMessage",s),this.adminMsg="",this.files=[],console.log("Сообщение отправлено")}}};const Ts=(0,y.Z)(Hs,[["render",$s],["__scopeId","data-v-1cf1a07e"]]);var Fs=Ts;const js=e=>((0,i.dD)("data-v-585e2d6e"),e=e(),(0,i.Cn)(),e),Ps={class:"style-changer"},Es={class:"style-changer__twin-blocks"},Vs=js((()=>(0,i._)("label",{for:"mainColor"},"Основной цвет чата:",-1))),Ns=js((()=>(0,i._)("label",{for:"mainColor"},"Основной текст чата:",-1))),Zs=js((()=>(0,i._)("label",{for:"adminMsgBackCol"},"Цвет сообщений админа:",-1))),Rs=js((()=>(0,i._)("label",{for:"adminMsgFontCol"},"Цвет текста сообщений админа:",-1))),Ys=js((()=>(0,i._)("label",{for:"usernameColor"},"Цвет имён:",-1))),Ks=js((()=>(0,i._)("label",{for:"mainBackColor"},"Цвет фона сообщений:",-1))),Qs=js((()=>(0,i._)("h4",null,"Расположение на странице:",-1))),Ws={class:"style-changer__position-choose"},Gs=js((()=>(0,i._)("label",{for:"positionChatLeft"},"Слева",-1))),qs=js((()=>(0,i._)("label",{for:"positionChatRight"},"Справа",-1))),Js=js((()=>(0,i._)("button",{type:"submit"},"Применить изменения",-1)));function Xs(e,s,t,n,l,o){const r=(0,i.up)("admin-user-chat-style");return(0,i.wg)(),(0,i.iD)("div",Ps,[(0,i._)("form",{onSubmit:s[8]||(s[8]=(0,a.iM)(((...e)=>o.sendStyle&&o.sendStyle(...e)),["prevent"]))},[(0,i._)("div",Es,[(0,i._)("div",null,[Vs,(0,i.wy)((0,i._)("input",{id:"mainColor","onUpdate:modelValue":s[0]||(s[0]=e=>l.mainColor=e),type:"color"},null,512),[[a.nr,l.mainColor]])]),(0,i._)("div",null,[Ns,(0,i.wy)((0,i._)("input",{id:"mainTextColor","onUpdate:modelValue":s[1]||(s[1]=e=>l.mainTextColor=e),type:"color"},null,512),[[a.nr,l.mainTextColor]])]),(0,i._)("div",null,[Zs,(0,i.wy)((0,i._)("input",{id:"adminMsgBackCol","onUpdate:modelValue":s[2]||(s[2]=e=>l.adminMsgBackCol=e),type:"color"},null,512),[[a.nr,l.adminMsgBackCol]])]),(0,i._)("div",null,[Rs,(0,i.wy)((0,i._)("input",{id:"adminMsgFontCol","onUpdate:modelValue":s[3]||(s[3]=e=>l.adminMsgFontCol=e),type:"color"},null,512),[[a.nr,l.adminMsgFontCol]])]),(0,i._)("div",null,[Ys,(0,i.wy)((0,i._)("input",{id:"usernameColor","onUpdate:modelValue":s[4]||(s[4]=e=>l.usernameColor=e),type:"color"},null,512),[[a.nr,l.usernameColor]])]),(0,i._)("div",null,[Ks,(0,i.wy)((0,i._)("input",{id:"mainBackColor","onUpdate:modelValue":s[5]||(s[5]=e=>l.mainBackColor=e),type:"color"},null,512),[[a.nr,l.mainBackColor]])])]),Qs,(0,i._)("div",Ws,[(0,i._)("div",null,[Gs,(0,i.wy)((0,i._)("input",{id:"positionChatLeft",value:"left",type:"radio","onUpdate:modelValue":s[6]||(s[6]=e=>l.chatPosition=e)},null,512),[[a.G2,l.chatPosition]])]),(0,i._)("div",null,[qs,(0,i.wy)((0,i._)("input",{id:"positionChatRight",value:"right",type:"radio","onUpdate:modelValue":s[7]||(s[7]=e=>l.chatPosition=e)},null,512),[[a.G2,l.chatPosition]])])]),Js],32),(0,i.Wm)(r,{chatColor:l.mainColor,adminMsgBackground:l.adminMsgBackCol,adminMsgFont:l.adminMsgFontCol,usernameColor:l.usernameColor,chatPosition:l.chatPosition,chatBackgroundColor:l.mainBackColor,mainTextColor:l.mainTextColor},null,8,["chatColor","adminMsgBackground","adminMsgFont","usernameColor","chatPosition","chatBackgroundColor","mainTextColor"])])}const et=e=>((0,i.dD)("data-v-6639c912"),e=e(),(0,i.Cn)(),e),st={class:"header__buttons"},tt=["fill"],at=et((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M.172 15.828a.5.5 0 0 0 .707 0l4.096-4.096V14.5a.5.5 0 1 0 1 0v-3.975a.5.5 0 0 0-.5-.5H1.5a.5.5 0 0 0 0 1h2.768L.172 15.121a.5.5 0 0 0 0 .707zM15.828.172a.5.5 0 0 0-.707 0l-4.096 4.096V1.5a.5.5 0 1 0-1 0v3.975a.5.5 0 0 0 .5.5H14.5a.5.5 0 0 0 0-1h-2.768L15.828.879a.5.5 0 0 0 0-.707z"},null,-1))),it=[at],nt={class:"logout"},lt=["fill"],ot=et((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"},null,-1))),rt=et((()=>(0,i._)("path",{"fill-rule":"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"},null,-1))),dt=[ot,rt],ht={class:"user-message-history__messages-list current-user"},ct={class:"user-message-history__messages-list__message-inner"},ut={class:"user-message-history__messages-list"},gt={class:"user-message-history__messages-list__message-inner"},mt={ref:"inpMes",rows:"2",cols:"4",placeholder:"Написать сообщение..."},pt={class:"input-msg-form__butt"},_t=et((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-arrow-right",viewBox:"0 0 16 16"},[(0,i._)("path",{"fill-rule":"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"})],-1))),ft=[_t],wt=et((()=>(0,i._)("input",{type:"submit",id:"subBut",value:"Отпр."},null,-1))),vt=et((()=>(0,i._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"16",fill:"currentColor",class:"bi bi-folder-symlink",viewBox:"0 0 16 16"},[(0,i._)("path",{d:"m11.798 8.271-3.182 1.97c-.27.166-.616-.036-.616-.372V9.1s-2.571-.3-4 2.4c.571-4.8 3.143-4.8 4-4.8v-.769c0-.336.346-.538.616-.371l3.182 1.969c.27.166.27.576 0 .742z"}),(0,i._)("path",{d:"m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14h10.348a2 2 0 0 0 1.991-1.819l.637-7A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm.694 2.09A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09l-.636 7a1 1 0 0 1-.996.91H2.826a1 1 0 0 1-.995-.91l-.637-7zM6.172 2a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"})],-1))),Ct=[vt];function yt(e,s,t,n,l,o){const r=(0,i.up)("user-chat-low");return l.isHigh?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,h.C_)(["chat","left"===t.chatPosition?"positionLeft":"positionRight"]),style:(0,h.j5)({backgroundColor:t.chatColor})},[(0,i._)("header",null,[(0,i._)("button",st,[((0,i.wg)(),(0,i.iD)("svg",{onClick:s[0]||(s[0]=(...e)=>o.changeSize&&o.changeSize(...e)),xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:t.mainTextColor,class:"bi bi-arrows-angle-contract",viewBox:"0 0 16 16"},it,8,tt))]),(0,i._)("button",nt,[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:t.mainTextColor,class:"bi bi-box-arrow-in-right",viewBox:"0 0 16 16"},dt,8,lt))]),(0,i._)("h1",{class:"header__greeting",style:(0,h.j5)({color:t.mainTextColor})}," Здравствуйте, Дмитрий ",4)]),(0,i._)("section",{class:"user-message-history",style:(0,h.j5)({backgroundColor:t.chatBackgroundColor}),ref:"chatter"},[(0,i._)("div",ht,[(0,i._)("div",ct,[(0,i._)("div",{class:"user-message-history__messages-list__message-inner__username",style:(0,h.j5)({color:t.usernameColor})},"Дмитрий",4),(0,i._)("div",{class:"user-message-history__messages-list__message-inner__content",style:(0,h.j5)({backgroundColor:t.chatColor})},[(0,i._)("p",{style:(0,h.j5)({color:t.mainTextColor})},"Привет",4)],4)])]),(0,i._)("div",ut,[(0,i._)("div",gt,[(0,i._)("div",{class:"user-message-history__messages-list__message-inner__username",style:(0,h.j5)({color:t.usernameColor})},"Админ",4),(0,i._)("div",{class:"user-message-history__messages-list__message-inner__content",style:(0,h.j5)({backgroundColor:t.adminMsgBackground})},[(0,i._)("p",{style:(0,h.j5)({color:t.adminMsgFont})},"Добрый вечер",4)],4)])])],4),(0,i._)("footer",null,[(0,i._)("form",{class:"input-msg-form",onSubmit:s[2]||(s[2]=(0,a.iM)((()=>{}),["prevent"]))},[(0,i._)("textarea",mt,null,512),(0,i._)("div",pt,[(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.chatColor,color:t.mainTextColor}),for:"subBut"},ft,4),wt,(0,i._)("label",{style:(0,h.j5)({backgroundColor:t.chatColor,color:t.mainTextColor}),for:"fileUp"},Ct,4),(0,i._)("input",{ref:"file",id:"fileUp",type:"file",onClick:s[1]||(s[1]=(0,a.iM)((()=>{}),["prevent"]))},null,512)])],32)])],6)):((0,i.wg)(),(0,i.j4)(r,{key:0,chatColor:t.chatColor,mainTextColor:t.mainTextColor,chatPosition:t.chatPosition,onSetLow:o.changeSize},null,8,["chatColor","mainTextColor","chatPosition","onSetLow"]))}var bt={data(){return{isHigh:!0}},components:{UserChatLow:fe},props:{chatColor:{type:String,default:"#7B68EE"},adminMsgBackground:{type:String,default:"#F3F3F3"},adminMsgFont:{type:String,default:"#000000"},usernameColor:{type:String,default:"#888888"},chatPosition:{type:String,default:"right"},chatBackgroundColor:{type:String,default:"#ffffff"},mainTextColor:{type:String,default:"#ffffff"}},methods:{changeSize(){this.isHigh=!this.isHigh}}};const Mt=(0,y.Z)(bt,[["render",yt],["__scopeId","data-v-6639c912"]]);var kt=Mt,St={data(){return{mainColor:"#7B68EE",mainBackColor:"#ffffff",chatPosition:"right",adminMsgBackCol:"#F3F3F3",adminMsgFontCol:"#000000",mainTextColor:"#ffffff",usernameColor:"#888888"}},components:{AdminUserChatStyle:kt},methods:{sendStyle(){console.log("отправка на сервер")}}};const Dt=(0,y.Z)(St,[["render",Xs],["__scopeId","data-v-585e2d6e"]]);var Lt=Dt,xt={components:{AdminClientsHeader:Qe,AdminClientsList:os,AdminMessages:Ss,AdminWriteMessage:Fs,AdminStyleChanger:Lt},sockets:{connect:function(){console.log("socket connected")}},mixins:[d],data(){return{dn:"none",db:"flex",clientOpen:!0,chosenStatus:1,lastMessageToUpdate:null,messagesUserId:null,addNewUser:null,userIdEndDialog:null,newMessage:null,isMessageOpen:!1,searchQueryText:"",isChangingStyleOpen:!1}},methods:{openClients(e){this.clientOpen=e},toClose(){this.$emit("close")},changeStatus(e){this.chosenStatus=e,this.isMessageOpen=!1},openMessages(e){this.messagesUserId=e,this.isMessageOpen=!0},updateClientList(e){this.lastMessageToUpdate=e},searchRequest(e){this.searchQueryText=e},openChangeStyle(){this.isMessageOpen=!1,this.isChangingStyleOpen=!this.isChangingStyleOpen},messageResponse(){try{this.sockets.subscribe("admin_response",(e=>{e.new_chat?this.addNewUser=e:(this.lastMessageToUpdate=e,this.newMessage=e)}))}catch(e){alert("Проблемы с подключением"),console.log(e)}},endDialog(e){this.userIdEndDialog=e}},created(){this.messageResponse()}};const Ut=(0,y.Z)(xt,[["render",Ue],["__scopeId","data-v-0186b900"]]);var It=Ut,Ot={components:{Chat:Ce,AdminChat:It}};const At=(0,y.Z)(Ot,[["render",n]]);var Bt=At,zt=t(119);function $t(e,s,t,a,n,l){const o=(0,i.up)("registrationAdmin"),r=(0,i.up)("AdminChat");return n.isIn?((0,i.wg)(),(0,i.j4)(r,{key:1,onClose:l.adminClose},null,8,["onClose"])):((0,i.wg)(),(0,i.j4)(o,{key:0,onAuth:l.checkAuth},null,8,["onAuth"]))}const Ht=e=>((0,i.dD)("data-v-2360f9c8"),e=e(),(0,i.Cn)(),e),Tt={id:"signin"},Ft=Ht((()=>(0,i._)("button",{type:"submit"},"",-1)));function jt(e,s,t,n,l,o){return(0,i.wg)(),(0,i.iD)("div",Tt,[(0,i._)("form",{id:"signin__form",onSubmit:s[2]||(s[2]=(0,a.iM)(((...e)=>o.logIn&&o.logIn(...e)),["prevent"])),autocomplete:"off"},[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>l.adminname=e),type:"text",id:"user",name:"user",placeholder:"username"},null,512),[[a.nr,l.adminname]]),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>l.password=e),type:"password",id:"pass",name:"pass",placeholder:"password"},null,512),[[a.nr,l.password]]),Ft],32),(0,i._)("p",null,(0,h.zw)(l.errorAuth),1)])}var Pt={mixins:[d],components:{AdminChat:It},data(){return{adminname:null,password:null,adminId:null,isIn:null,connection:null,errorAuth:null}},methods:{async logIn(){if(this.adminname&&this.password&&""!==this.adminname&&""!==this.password){this.adminname=this.adminname.trim(),console.log("Starting");const e={name:this.adminname,password:this.password};await v().put(`${this.myProxy}/admin/login`,{},{params:e}).then((e=>{console.log(e),e.data.error?this.errorAuth="Неверный логин или пароль!":(sessionStorage.setItem("is_auth",e.data.auth.toString()),sessionStorage.setItem("user",JSON.stringify(e.data.user)),this.checkAuth())}))}else alert("Введите имя и пароль!")},checkAuth(){this.$emit("auth")}},mounted(){this.checkAuth()}};const Et=(0,y.Z)(Pt,[["render",jt],["__scopeId","data-v-2360f9c8"]]);var Vt=Et,Nt={mixins:[d],components:{AdminChat:It,registrationAdmin:Vt},data(){return{isIn:!1}},methods:{checkAuth(){"true"===sessionStorage.getItem("is_auth")?this.isIn=!0:this.isIn=!1},adminClose(){sessionStorage.clear(),this.checkAuth(),this.adminname=null,this.password=null}},mounted(){this.checkAuth()}};const Zt=(0,y.Z)(Nt,[["render",$t]]);var Rt=Zt;const Yt=[{path:"/",component:Ce},{path:"/admin",component:Rt}],Kt=(0,zt.p7)({routes:Yt,history:(0,zt.PO)("/chat/")});var Qt=Kt,Wt=t(760),Gt=t.n(Wt);const qt=new(Gt())({debug:!0,connection:"http://31.28.9.200:23765"});var Jt=qt;(0,a.ri)(Bt).use(Qt).use(Jt).mount("#app")}},s={};function t(a){var i=s[a];if(void 0!==i)return i.exports;var n=s[a]={exports:{}};return e[a].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,a,i,n){if(!a){var l=1/0;for(h=0;h<e.length;h++){a=e[h][0],i=e[h][1],n=e[h][2];for(var o=!0,r=0;r<a.length;r++)(!1&n||l>=n)&&Object.keys(t.O).every((function(e){return t.O[e](a[r])}))?a.splice(r--,1):(o=!1,n<l&&(l=n));if(o){e.splice(h--,1);var d=i();void 0!==d&&(s=d)}}return s}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[a,i,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,a){var i,n,l=a[0],o=a[1],r=a[2],d=0;if(l.some((function(s){return 0!==e[s]}))){for(i in o)t.o(o,i)&&(t.m[i]=o[i]);if(r)var h=r(t)}for(s&&s(a);d<l.length;d++)n=l[d],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(h)},a=self["webpackChunkchat"]=self["webpackChunkchat"]||[];a.forEach(s.bind(null,0)),a.push=s.bind(null,a.push.bind(a))}();var a=t.O(void 0,[998],(function(){return t(255)}));a=t.O(a)})();
//# sourceMappingURL=app.947c4c3a.js.map